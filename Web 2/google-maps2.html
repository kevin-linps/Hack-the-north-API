<!DOCTYPE html>
<html>
  <head>
        <link href="./google-maps.css" rel="stylesheet">
        <script type="text/javascript" src="TD_API_JS.js"></script>


    <style>
       /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
    </style>

    <title>Today's Date</title>
    <script>
        //let d = jsonResponse.result.givenName;
  var myInit = {
    body: "continuationToken",
    method: 'POST',
    headers: {
      'Authorization': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJDQlAiLCJ0ZWFtX2lkIjoiMDJkZTU0ZDQtY2ZkOC0zNGFkLThiNWYtYzZjODkwZDdjOTc5IiwiZXhwIjo5MjIzMzcyMDM2ODU0Nzc1LCJhcHBfaWQiOiI3ZjIwMDMyNy0xMjE1LTQ3NmUtODEwNy1jOWQzMmE3MGQ1M2QifQ.XsJpJCXbibxFPcS98rdsKa5mQFT4uK8XUwtZMycF_e8'
    } 
  };
  var myRequest = new Request('https://api.td-davinci.com/api/raw-customer-data', myInit);
  var jsonResponse ='test';
  var uluru;


  function myFunc() {
  fetch(myRequest)
    .then(response => response.json())
    .then(json => {uluru = {lat: json.result.addresses.principalResidence.latitude, lng: json.result.addresses.principalResidence.longitude};})
    .then(value => initMap())
    .then(value => alert("hello"))
    
}
myFunc();
//alert(jsonResponse);

    </script>
  </head>
  <body>
    <h3>My Google Maps Demo</h3>
    <!--The div element for the map -->
    <div id="map"></div>
    <script>
//var uluru = {lat: -50.344, lng: 231.036};
// Initialize and add the map
function initMap() {
  // The location of Uluru
   //uluru = {lat: -25.344, lng: 131.036};
  // The map, centered at Uluru
  var map = new google.maps.Map(
      document.getElementById('map'), {zoom: 4, center: uluru});
  // The marker, positioned at Uluru
  var marker = new google.maps.Marker({position: uluru, map: map});
}
    </script>
    <!--Load the API from the specified URL
    * The async attribute allows the browser to render the page while the API loads
    * The key parameter will contain your own API key (which is not needed for this tutorial)
    * The callback parameter executes the initMap() function
    -->
    <script async="false" defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXqpOye7ErVZlJrXSOXaj1ZlxSimO1HGw&callback=initMap">
    </script>
  </body>
</html>